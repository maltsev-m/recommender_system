## Рекомендательная система
В данном проекте разработана рекомендательная система. Сервис на основании признаков пользователей и постов, а также взаимодействия между ними, возвращает по запросу для юзера N постов, которые пользователю покажут в его ленте соцсети.

Работа выполнена на Python 3.9.19.

### Стек:
NumPy, Pandas, Matplotlib, Seaborn, Scikit-learn, CatBoost, LightGBM, FastAPI, SQLAlchemy, Pydantic

### Задачи: 
1. Загрузить данные из БД.
2. Обработать данные: преобразовать форматы, поработать с пропущенными значениями, нормализовать данные.
3. Провести фича-инжиниринг, создавая признаки для модели на основе доступных данных.
4. Выбрать и обучить модель машинного обучения, используя библиотеки Python.
5. Проверить качество модели с использованием метрик и на кросс-валидации.
6. Загрузить на сервер подготовленные фичи и обученную моделью.
7. Написать сервис на FastAPI со следующим алгоритмом работы:
    - запуск сервиса:
        * загрузка предобученной ранее модели
        * загрузка подготовленных фичей
    - endpoint:
        * фильтрация фичей пользователя по id
        * загрузка фичей постов для юзера
        * объединим фичи юзеров и постов через feed_action
        * выделим фичи из даты
        * определим для юзера вероятности лайка постов
        * уберем лайкнутые ранее посты
        * рекомендуем топ постов

### Полученные результаты:
Данные обработаны, фичи подготовлены, модель обучена; качество модели на кросс-валидации составляет: recall=0.78; сервис работает корректно, время обработки одного запроса не более 0,5с; hitrate@5 на 2000 запросах составляет 0,593

### Рабочие файлы:
**project.ipynb** - ноутбук с обработкой признаков и обучением модели

**service** -  папка с файлами сервиса

**endpoint.py** - файл приложения с endpoint.

**model_lgbm.pkl** - предобученная модель LightGBM

**table_user.py** - ORM таблица пользователей

**table_post.py** - ORM таблица постов социальной сети

**table_feed.py** - ORM таблица взаимодействий пользователей и постов

**database.py** - скрипт с подключение к базе данных

**schemas.py** - модели валидации pydentic

**requirements.txt** - необходимые библиотеки